<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
         xmlns:security="http://www.springframework.org/schema/security"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://www.springframework.org/schema/beans
                             http://www.springframework.org/schema/beans/spring-beans.xsd
                             http://www.springframework.org/schema/security
                             http://www.springframework.org/schema/security/spring-security.xsd">
  
  <!--
    1、设置放行资源，如登录注册页面，静态资源css、js等等
        security="none" 设置此资源不被拦截.
    -->
  <security:http pattern="/login" security="none"></security:http>
  
  <security:http auto-config="true" use-expressions="true">
    <security:csrf disabled="true"/>
    <security:form-login
      login-page="/login"
      default-target-url="/admin"
      login-processing-url="/j_spring_security_check"
      username-parameter="username"
      password-parameter="password"
      authentication-success-handler-ref="authenticationSuccessHandlerImpl"
      authentication-failure-handler-ref="authenticationFailureHandlerImpl"
    />
    <security:logout
      logout-url="/j_spring_security_logout"
      logout-success-url="/login"
      invalidate-session="true"
    />
    <security:intercept-url pattern="/*" access="isAuthenticated()"/>
    <!--<security:intercept-url pattern="/*" access="hasRole('ROLE_ADMIN')"/>-->
    <security:access-denied-handler error-page="/403.jsp" />
  </security:http>
  
  
  <!-- 认证成功后的处理类 -->
  <bean id="authenticationSuccessHandlerImpl" class="com.admin.security.AuthenticationSuccessHandlerImpl"/>
  <!-- 认证失败后的处理类 -->
  <bean id="authenticationFailureHandlerImpl" class="com.admin.security.AuthenticationFailureHandlerImpl"/>
  
  <security:authentication-manager alias="authenticationManager">
    <security:authentication-provider user-service-ref="userDetailsServiceImpl">
      <security:password-encoder hash="md5">
        <security:salt-source user-property="username"/>
      </security:password-encoder>
    </security:authentication-provider>
  </security:authentication-manager>
  
  <bean id="userDetailsServiceImpl" class="com.admin.security.UserDetailsServiceImpl"></bean>
 
</beans>